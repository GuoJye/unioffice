# UniOffice è®¸å¯è¯ç”Ÿæˆå™¨ - å®Œæ•´ä½¿ç”¨æ•™ç¨‹

## ğŸ“– ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
2. [è¯¦ç»†æ­¥éª¤](#è¯¦ç»†æ­¥éª¤)
3. [é«˜çº§ç”¨æ³•](#é«˜çº§ç”¨æ³•)
4. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
5. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸‰æ­¥ç”Ÿæˆå¹¶ä½¿ç”¨è®¸å¯è¯

```bash
# 1. è¿›å…¥æµ‹è¯•ç›®å½•
cd /workspaces/unioffice/test

# 2. ç”Ÿæˆè®¸å¯è¯ï¼ˆä½¿ç”¨å·²æœ‰çš„å¯†é’¥ï¼‰
go run license_gen.go -customer "YourCompanyName" -output license.key -privkey new_private.pem

# 3. éªŒè¯è®¸å¯è¯æ˜¯å¦å¯ç”¨
go run test_license.go
```

å¦‚æœçœ‹åˆ° `âœ… All tests passed!`ï¼Œè¯´æ˜è®¸å¯è¯å·²ç»æˆåŠŸç”Ÿæˆå¹¶å¯ç”¨ï¼

---

## ğŸ“š è¯¦ç»†æ­¥éª¤

### æ­¥éª¤ 1: å‡†å¤‡ç¯å¢ƒ

ç¡®ä¿æ‚¨åœ¨æ­£ç¡®çš„ç›®å½•ï¼š

```bash
cd /workspaces/unioffice/test
```

æ£€æŸ¥å¿…è¦æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š

```bash
ls -l license_gen.go new_private.pem
```

æ‚¨åº”è¯¥çœ‹åˆ°ï¼š
- `license_gen.go` - è®¸å¯è¯ç”Ÿæˆå™¨ç¨‹åº
- `new_private.pem` - RSA ç§é’¥æ–‡ä»¶

### æ­¥éª¤ 2: ç”Ÿæˆè®¸å¯è¯

#### åŸºç¡€ç”¨æ³•

```bash
go run license_gen.go -customer "æ‚¨çš„å®¢æˆ·åç§°" -output license.key -privkey new_private.pem
```

**å‚æ•°è¯´æ˜**ï¼š
- `-customer "å®¢æˆ·åç§°"` - **å¿…å¡«**ï¼Œå®¢æˆ·æˆ–å…¬å¸åç§°ï¼Œå¿…é¡»ä¸ä½¿ç”¨æ—¶çš„åç§°å®Œå…¨ä¸€è‡´
- `-output license.key` - è¾“å‡ºæ–‡ä»¶åï¼Œé»˜è®¤ä¸º `license.key`
- `-privkey new_private.pem` - ç§é’¥æ–‡ä»¶è·¯å¾„

**ç¤ºä¾‹**ï¼š

```bash
# ä¸º "ABC Company" ç”Ÿæˆè®¸å¯è¯
go run license_gen.go -customer "ABC Company" -output abc_license.key -privkey new_private.pem

# ä¸º "æµ‹è¯•ç”¨æˆ·" ç”Ÿæˆè®¸å¯è¯
go run license_gen.go -customer "æµ‹è¯•ç”¨æˆ·" -output test_license.key -privkey new_private.pem

# ä¸º "John Doe" ç”Ÿæˆä¸ªäººè®¸å¯è¯
go run license_gen.go -customer "John Doe" -output john_license.key -privkey new_private.pem
```

**æˆåŠŸè¾“å‡ºç¤ºä¾‹**ï¼š

```
Generated license content:
-----BEGIN UNIDOC LICENSE KEY-----
eyJsaWNlbnNlX2lkIjoiMTIzNDU2Nzg5MEFCQ0RFRiIsImN1c3RvbWVyX2lkIjoiQ1VTVDE...
+
RgY+/3hEPUHHz8nLrJT8NoWAMxuFviQxzjUmS3s7NOppg/3NSuLZe1x27uZBtjuHlnTk...
-----END UNIDOC LICENSE KEY-----

âœ“ License generated successfully!
  File: abc_license.key
  Customer: ABC Company
```

### æ­¥éª¤ 3: éªŒè¯è®¸å¯è¯

åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•ç¨‹åºæ¥éªŒè¯è®¸å¯è¯ï¼š

```bash
# æ–¹æ³• 1: ä½¿ç”¨æä¾›çš„æµ‹è¯•ç¨‹åºï¼ˆéœ€è¦å°†è®¸å¯è¯é‡å‘½åä¸º license.keyï¼‰
cp abc_license.key license.key
go run test_license.go
```

æˆ–è€…åˆ›å»ºè‡ªå·±çš„éªŒè¯ç¨‹åºï¼š

```go
// my_test.go
package main

import (
    "fmt"
    "os"
    "github.com/unidoc/unioffice/v2/common/license"
    "github.com/unidoc/unioffice/v2/document"
)

func main() {
    // è¯»å–è®¸å¯è¯æ–‡ä»¶
    licenseContent, err := os.ReadFile("abc_license.key")
    if err != nil {
        fmt.Printf("âŒ æ— æ³•è¯»å–è®¸å¯è¯: %v\n", err)
        return
    }

    // éªŒè¯è®¸å¯è¯ï¼ˆå®¢æˆ·åç§°å¿…é¡»ä¸ç”Ÿæˆæ—¶ä¸€è‡´ï¼ï¼‰
    err = license.SetLicenseKey(string(licenseContent), "ABC Company")
    if err != nil {
        fmt.Printf("âŒ è®¸å¯è¯éªŒè¯å¤±è´¥: %v\n", err)
        return
    }

    fmt.Println("âœ… è®¸å¯è¯éªŒè¯æˆåŠŸï¼")

    // æµ‹è¯•åˆ›å»ºæ–‡æ¡£
    doc := document.New()
    para := doc.AddParagraph()
    run := para.AddRun()
    run.AddText("Hello UniOffice!")
    
    err = doc.SaveToFile("output.docx")
    if err != nil {
        fmt.Printf("âŒ æ–‡æ¡£ä¿å­˜å¤±è´¥: %v\n", err)
        return
    }

    fmt.Println("âœ… æ–‡æ¡£åˆ›å»ºæˆåŠŸ: output.docx")
}
```

è¿è¡ŒéªŒè¯ï¼š

```bash
go run my_test.go
```

### æ­¥éª¤ 4: åœ¨æ‚¨çš„é¡¹ç›®ä¸­ä½¿ç”¨

#### 4.1 é…ç½® go.mod

ç¡®ä¿æ‚¨çš„é¡¹ç›® `go.mod` æ–‡ä»¶åŒ…å«æ­£ç¡®çš„é…ç½®ï¼š

```go
module your-project

go 1.21

// å¦‚æœä½¿ç”¨æœ¬åœ°ä¿®æ”¹çš„ unioffice
replace github.com/unidoc/unioffice/v2 => /path/to/unioffice

require github.com/unidoc/unioffice/v2 v2.0.0
```

#### 4.2 åœ¨ä»£ç ä¸­åŠ è½½è®¸å¯è¯

```go
package main

import (
    "os"
    "github.com/unidoc/unioffice/v2/common/license"
    "github.com/unidoc/unioffice/v2/document"
)

func init() {
    // ç¨‹åºå¯åŠ¨æ—¶åŠ è½½è®¸å¯è¯
    licenseKey, err := os.ReadFile("license.key")
    if err != nil {
        panic("æ— æ³•è¯»å–è®¸å¯è¯æ–‡ä»¶: " + err.Error())
    }

    err = license.SetLicenseKey(string(licenseKey), "YourCompanyName")
    if err != nil {
        panic("è®¸å¯è¯éªŒè¯å¤±è´¥: " + err.Error())
    }
}

func main() {
    // ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨ unioffice åŠŸèƒ½
    doc := document.New()
    // ... æ‚¨çš„ä»£ç 
}
```

---

## ğŸ¯ é«˜çº§ç”¨æ³•

### è°ƒè¯•æ¨¡å¼

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å¯ç”¨è°ƒè¯•æ¨¡å¼æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼š

```bash
go run license_gen.go -customer "TestUser" -output test.key -privkey new_private.pem -debug
```

è°ƒè¯•è¾“å‡ºç¤ºä¾‹ï¼š

```
Generating license for customer: TestUser
JSON: {"license_id":"1234567890ABCDEF",...}
JSON Length: 316 bytes
SHA512: 1d8922f6421060572d0b8a6338457e06...
Signature: 725587df94ea6ea3622c12914de95237...
Signature Length: 256 bytes
Self-verification: âœ“ PASSED

âœ“ License generated successfully!
```

### ç”Ÿæˆæ–°çš„å¯†é’¥å¯¹ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰

âš ï¸ **æ³¨æ„**ï¼šåªæœ‰åœ¨éœ€è¦ä½¿ç”¨è‡ªå·±çš„å¯†é’¥æ—¶æ‰æ‰§è¡Œæ­¤æ­¥éª¤ã€‚ä½¿ç”¨æ–°å¯†é’¥éœ€è¦ä¿®æ”¹æºä»£ç ï¼

```bash
# ç”Ÿæˆæ–°çš„ RSA å¯†é’¥å¯¹
go run license_gen.go -genkeys -privkey my_private.pem -pubkey my_public.pem
```

è¿™å°†è¾“å‡ºï¼š

```
Generated new RSA key pair:
  Private key: my_private.pem
  Public key: my_public.pem

Public key (PEM format for source code):
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...
-----END PUBLIC KEY-----

Public key hex: 30820122300d06092a864886f70d...

âš ï¸  IMPORTANT: Replace const _dba in internal/license/license.go with the PEM format above!
```

**ä¿®æ”¹æºä»£ç **ï¼š

1. å¤åˆ¶è¾“å‡ºçš„ "Public key (PEM format)" Unicode è½¬ä¹‰ç‰ˆæœ¬
2. æ‰“å¼€ `/workspaces/unioffice/internal/license/license.go`
3. æ‰¾åˆ°ç¬¬ 894 è¡Œçš„ `const _dba = "..."`
4. æ›¿æ¢æ•´ä¸ªå¸¸é‡å€¼

### è‡ªå®šä¹‰è®¸å¯è¯å‚æ•°

ç¼–è¾‘ `license_gen.go` å¯ä»¥è‡ªå®šä¹‰æ›´å¤šå‚æ•°ï¼š

```go
// åœ¨ generateLicense å‡½æ•°ä¸­ä¿®æ”¹
license := LicenseData{
    LicenseId:    "YOUR-CUSTOM-ID",           // è‡ªå®šä¹‰è®¸å¯è¯ID
    CustomerId:   "CUSTOMER-ID",              // è‡ªå®šä¹‰å®¢æˆ·ID
    CustomerName: customerName,
    Tier:         "business",                  // è®¸å¯çº§åˆ«: community/individual/business
    CreatedAt:    time.Now().Unix(),
    ExpiresAt:    0,                          // 0 è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼Œæˆ–è®¾ç½® Unix æ—¶é—´æˆ³
    CreatedBy:    "your-system",              // åˆ›å»ºè€…æ ‡è¯†
    CreatorName:  "Your System",              // åˆ›å»ºè€…åç§°
    CreatorEmail: "admin@yourcompany.com",    // è”ç³»é‚®ç®±
    UniPDF:       true,                       // å¯ç”¨ UniPDF
    UniOffice:    true,                       // å¯ç”¨ UniOffice
    UniHTML:      true,                       // å¯ç”¨ UniHTML
    Trial:        false,                      // false = æ­£å¼ç‰ˆ, true = è¯•ç”¨ç‰ˆ
}
```

### æ‰¹é‡ç”Ÿæˆè®¸å¯è¯

åˆ›å»ºä¸€ä¸ªè„šæœ¬æ‰¹é‡ç”Ÿæˆï¼š

```bash
#!/bin/bash
# batch_generate.sh

customers=("Company A" "Company B" "Company C")

for customer in "${customers[@]}"; do
    filename=$(echo "$customer" | tr ' ' '_' | tr '[:upper:]' '[:lower:]')_license.key
    echo "Generating license for: $customer"
    go run license_gen.go -customer "$customer" -output "$filename" -privkey new_private.pem
    echo "---"
done

echo "âœ… All licenses generated!"
```

è¿è¡Œï¼š

```bash
chmod +x batch_generate.sh
./batch_generate.sh
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: å®¢æˆ·åç§°å¿…é¡»å®Œå…¨ä¸€è‡´å—ï¼Ÿ

**A**: æ˜¯çš„ï¼ç”Ÿæˆè®¸å¯è¯æ—¶ä½¿ç”¨çš„å®¢æˆ·åç§°å¿…é¡»ä¸è°ƒç”¨ `license.SetLicenseKey()` æ—¶çš„åç§°**å®Œå…¨ä¸€è‡´**ï¼ˆåŒ…æ‹¬å¤§å°å†™ã€ç©ºæ ¼ç­‰ï¼‰ã€‚

âŒ é”™è¯¯ç¤ºä¾‹ï¼š
```bash
# ç”Ÿæˆæ—¶
go run license_gen.go -customer "ABC Company" ...

# ä½¿ç”¨æ—¶
license.SetLicenseKey(content, "abc company")  // âŒ å¤§å°å†™ä¸åŒ¹é…
license.SetLicenseKey(content, "ABC  Company") // âŒ å¤šäº†ç©ºæ ¼
```

âœ… æ­£ç¡®ç¤ºä¾‹ï¼š
```bash
# ç”Ÿæˆæ—¶
go run license_gen.go -customer "ABC Company" ...

# ä½¿ç”¨æ—¶
license.SetLicenseKey(content, "ABC Company")  // âœ… å®Œå…¨ä¸€è‡´
```

### Q2: è®¸å¯è¯å¯ä»¥åœ¨å¤šå°æœºå™¨ä¸Šä½¿ç”¨å—ï¼Ÿ

**A**: å¯ä»¥ã€‚åŒä¸€ä¸ªè®¸å¯è¯æ–‡ä»¶å¯ä»¥å¤åˆ¶åˆ°å¤šå°æœºå™¨ä¸Šä½¿ç”¨ï¼Œåªè¦å®¢æˆ·åç§°åŒ¹é…å³å¯ã€‚

### Q3: è®¸å¯è¯ä¼šè¿‡æœŸå—ï¼Ÿ

**A**: é»˜è®¤ç”Ÿæˆçš„è®¸å¯è¯ `expires_at` ä¸º 0ï¼Œè¡¨ç¤ºæ°¸ä¸è¿‡æœŸã€‚å¦‚éœ€è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œéœ€è¦ä¿®æ”¹ä»£ç ä¸­çš„ `ExpiresAt` å­—æ®µã€‚

### Q4: å¦‚ä½•ä¿®æ”¹è®¸å¯è¯çš„æœ‰æ•ˆæœŸï¼Ÿ

**A**: ç¼–è¾‘ `license_gen.go`ï¼Œä¿®æ”¹ `ExpiresAt` å­—æ®µï¼š

```go
ExpiresAt: time.Now().AddDate(1, 0, 0).Unix(), // 1å¹´åè¿‡æœŸ
```

### Q5: å¯ä»¥ç¦ç”¨æŸäº›åŠŸèƒ½å—ï¼ˆå¦‚åªå¯ç”¨ UniOfficeï¼‰ï¼Ÿ

**A**: å¯ä»¥ï¼Œç¼–è¾‘ `license_gen.go`ï¼š

```go
UniPDF:    false,  // ç¦ç”¨ UniPDF
UniOffice: true,   // å¯ç”¨ UniOffice
UniHTML:   false,  // ç¦ç”¨ UniHTML
```

### Q6: ç§é’¥ä¸¢å¤±äº†æ€ä¹ˆåŠï¼Ÿ

**A**: å¦‚æœç§é’¥ï¼ˆ`new_private.pem`ï¼‰ä¸¢å¤±ï¼š
1. å·²ç”Ÿæˆçš„è®¸å¯è¯ä»ç„¶å¯ä»¥ä½¿ç”¨
2. ä½†æ— æ³•ç”Ÿæˆæ–°çš„è®¸å¯è¯
3. éœ€è¦é‡æ–°ç”Ÿæˆå¯†é’¥å¯¹å¹¶ä¿®æ”¹æºä»£ç ä¸­çš„å…¬é’¥

### Q7: è®¸å¯è¯æ–‡ä»¶å¯ä»¥é‡å‘½åå—ï¼Ÿ

**A**: å¯ä»¥ï¼Œè®¸å¯è¯æ–‡ä»¶åä¸å½±å“åŠŸèƒ½ï¼Œåªè¦åœ¨åŠ è½½æ—¶æŒ‡å®šæ­£ç¡®çš„æ–‡ä»¶åå³å¯ã€‚

### Q8: å¦‚ä½•åœ¨ Docker å®¹å™¨ä¸­ä½¿ç”¨ï¼Ÿ

**A**: å°†è®¸å¯è¯æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨ä¸­ï¼š

```dockerfile
FROM golang:1.21
WORKDIR /app
COPY license.key /app/
COPY . /app/
RUN go build -o myapp
CMD ["./myapp"]
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é”™è¯¯ 1: "crypto/rsa: verification error"

**åŸå› **ï¼šç­¾åéªŒè¯å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„ç§é’¥ç”Ÿæˆè®¸å¯è¯
2. ç¡®è®¤æºä»£ç ä¸­çš„å…¬é’¥å·²æ­£ç¡®æ›¿æ¢
3. ç¡®è®¤ `go.mod` é…ç½®æ­£ç¡®ï¼Œä½¿ç”¨çš„æ˜¯æœ¬åœ°ä¿®æ”¹çš„ä»£ç 

**æ£€æŸ¥æ­¥éª¤**ï¼š
```bash
# 1. æ£€æŸ¥ go.mod
cat go.mod | grep replace

# åº”è¯¥çœ‹åˆ°ï¼š
# replace github.com/unidoc/unioffice/v2 => ../

# 2. é‡æ–°ç”Ÿæˆè®¸å¯è¯
go run license_gen.go -customer "Test" -output test.key -privkey new_private.pem -debug

# 3. æŸ¥çœ‹è‡ªéªŒè¯ç»“æœ
# åº”è¯¥çœ‹åˆ° "Self-verification: âœ“ PASSED"
```

### é”™è¯¯ 2: "customer name mismatch"

**åŸå› **ï¼šå®¢æˆ·åç§°ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**ï¼š
æ£€æŸ¥ç”Ÿæˆå’Œä½¿ç”¨æ—¶çš„å®¢æˆ·åç§°æ˜¯å¦å®Œå…¨ä¸€è‡´ï¼š

```bash
# æŸ¥çœ‹è®¸å¯è¯ä¸­çš„å®¢æˆ·åç§°
cat license.key | head -2 | tail -1 | base64 -d | jq .customer_name
```

### é”™è¯¯ 3: "License file not found"

**åŸå› **ï¼šè®¸å¯è¯æ–‡ä»¶è·¯å¾„é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -l license.key

# ç¡®è®¤è·¯å¾„æ­£ç¡®
pwd
```

### é”™è¯¯ 4: å¯¼å…¥è·¯å¾„é”™è¯¯

**åŸå› **ï¼šä½¿ç”¨äº†é”™è¯¯çš„å¯¼å…¥è·¯å¾„

**è§£å†³æ–¹æ¡ˆ**ï¼š
ç¡®ä¿å¯¼å…¥è·¯å¾„åŒ…å« `/v2`ï¼š

```go
// âœ… æ­£ç¡®
import "github.com/unidoc/unioffice/v2/common/license"
import "github.com/unidoc/unioffice/v2/document"

// âŒ é”™è¯¯
import "github.com/unidoc/unioffice/common/license"
import "github.com/unidoc/unioffice/document"
```

### é”™è¯¯ 5: ä½¿ç”¨äº†è¿œç¨‹åŒ…è€Œéæœ¬åœ°ä»£ç 

**ç—‡çŠ¶**ï¼šä¿®æ”¹äº†æºä»£ç ä½†ä¸ç”Ÿæ•ˆ

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. æ£€æŸ¥ `go.mod`ï¼š
```bash
cat go.mod
```

åº”è¯¥åŒ…å«ï¼š
```
replace github.com/unidoc/unioffice/v2 => ../
require github.com/unidoc/unioffice/v2 v2.0.0
```

2. æ¸…ç†ç¼“å­˜å¹¶é‡æ–°ç¼–è¯‘ï¼š
```bash
go clean -cache -modcache
go mod tidy
```

### è°ƒè¯•æŠ€å·§

#### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—

```go
import "github.com/unidoc/unioffice/v2/common/logger"

func init() {
    logger.Log.SetLogLevel(logger.LogLevelDebug)
}
```

#### 2. æŸ¥çœ‹è®¸å¯è¯å†…å®¹

```bash
# è§£ç è®¸å¯è¯ JSON éƒ¨åˆ†
cat license.key | sed -n '2p' | base64 -d | jq .
```

#### 3. éªŒè¯ç­¾å

```bash
# ä½¿ç”¨è°ƒè¯•æ¨¡å¼ç”Ÿæˆå¹¶æŸ¥çœ‹å“ˆå¸Œå€¼
go run license_gen.go -customer "Test" -output test.key -privkey new_private.pem -debug
```

---

## ğŸ“‹ å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹ 1: ç®€å•åº”ç”¨

```go
// main.go
package main

import (
    "fmt"
    "os"
    "github.com/unidoc/unioffice/v2/common/license"
    "github.com/unidoc/unioffice/v2/document"
)

func main() {
    // åŠ è½½è®¸å¯è¯
    licData, err := os.ReadFile("license.key")
    if err != nil {
        panic(err)
    }

    // éªŒè¯è®¸å¯è¯
    err = license.SetLicenseKey(string(licData), "MyCompany")
    if err != nil {
        panic(err)
    }

    // åˆ›å»ºæ–‡æ¡£
    doc := document.New()
    para := doc.AddParagraph()
    run := para.AddRun()
    run.AddText("Hello from MyCompany!")
    
    doc.SaveToFile("output.docx")
    fmt.Println("âœ… Document created successfully!")
}
```

### ç¤ºä¾‹ 2: Web æœåŠ¡

```go
// server.go
package main

import (
    "fmt"
    "net/http"
    "os"
    "github.com/unidoc/unioffice/v2/common/license"
    "github.com/unidoc/unioffice/v2/document"
)

func init() {
    // æœåŠ¡å¯åŠ¨æ—¶åŠ è½½è®¸å¯è¯
    licData, err := os.ReadFile("license.key")
    if err != nil {
        panic("License file not found: " + err.Error())
    }

    err = license.SetLicenseKey(string(licData), "WebService Inc")
    if err != nil {
        panic("License validation failed: " + err.Error())
    }
    
    fmt.Println("âœ… License loaded successfully")
}

func generateReport(w http.ResponseWriter, r *http.Request) {
    // ä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆæ–‡æ¡£
    doc := document.New()
    para := doc.AddParagraph()
    run := para.AddRun()
    run.AddText("Generated Report")
    
    // ä¿å­˜åˆ°ä¸´æ—¶æ–‡ä»¶å¹¶å‘é€
    tmpFile := "/tmp/report.docx"
    doc.SaveToFile(tmpFile)
    
    http.ServeFile(w, r, tmpFile)
}

func main() {
    http.HandleFunc("/generate", generateReport)
    fmt.Println("Server running on :8080")
    http.ListenAndServe(":8080", nil)
}
```

### ç¤ºä¾‹ 3: å‘½ä»¤è¡Œå·¥å…·

```go
// converter.go
package main

import (
    "flag"
    "fmt"
    "os"
    "github.com/unidoc/unioffice/v2/common/license"
    "github.com/unidoc/unioffice/v2/document"
)

func main() {
    input := flag.String("input", "", "Input text file")
    output := flag.String("output", "output.docx", "Output docx file")
    flag.Parse()

    // åŠ è½½è®¸å¯è¯
    licData, _ := os.ReadFile("license.key")
    license.SetLicenseKey(string(licData), "ConverterTool")

    // è¯»å–è¾“å…¥æ–‡ä»¶
    content, err := os.ReadFile(*input)
    if err != nil {
        fmt.Printf("Error reading input: %v\n", err)
        return
    }

    // åˆ›å»º Word æ–‡æ¡£
    doc := document.New()
    para := doc.AddParagraph()
    run := para.AddRun()
    run.AddText(string(content))

    // ä¿å­˜
    doc.SaveToFile(*output)
    fmt.Printf("âœ… Converted %s to %s\n", *input, *output)
}
```

ä½¿ç”¨ï¼š
```bash
go run converter.go -input readme.txt -output readme.docx
```

---

## ğŸ“¦ éƒ¨ç½²æ¸…å•

éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶éœ€è¦çš„æ–‡ä»¶ï¼š

### å¿…éœ€æ–‡ä»¶
- âœ… `license.key` - ç”Ÿæˆçš„è®¸å¯è¯æ–‡ä»¶
- âœ… æ‚¨çš„åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶æˆ–æºä»£ç 

### ä¸éœ€è¦çš„æ–‡ä»¶
- âŒ `new_private.pem` - ç§é’¥ï¼ˆä»…ç”Ÿæˆæ—¶éœ€è¦ï¼Œä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼ï¼‰
- âŒ `license_gen.go` - ç”Ÿæˆå™¨ï¼ˆä»…å¼€å‘æ—¶éœ€è¦ï¼‰
- âŒ `test_*.go` - æµ‹è¯•æ–‡ä»¶

### å®‰å…¨å»ºè®®
1. ğŸ”’ **ç§é’¥ä¿å¯†**ï¼šå°† `new_private.pem` å­˜å‚¨åœ¨å®‰å…¨çš„ä½ç½®ï¼Œä¸è¦æäº¤åˆ°ä»£ç ä»“åº“
2. ğŸ”’ **è®¿é—®æ§åˆ¶**ï¼šé™åˆ¶è°å¯ä»¥ç”Ÿæˆè®¸å¯è¯
3. ğŸ”’ **å¤‡ä»½**ï¼šå®šæœŸå¤‡ä»½ç§é’¥æ–‡ä»¶
4. ğŸ“ **å®¡è®¡**ï¼šè®°å½•æ‰€æœ‰è®¸å¯è¯ç”Ÿæˆæ“ä½œ

---

## ğŸ“ æ€»ç»“

### æœ€ç®€å•çš„ä½¿ç”¨æµç¨‹

```bash
# 1ï¸âƒ£ ç”Ÿæˆè®¸å¯è¯
cd /workspaces/unioffice/test
go run license_gen.go -customer "YourName" -output license.key -privkey new_private.pem

# 2ï¸âƒ£ åœ¨ä»£ç ä¸­ä½¿ç”¨
# å°† license.key å¤åˆ¶åˆ°æ‚¨çš„é¡¹ç›®ç›®å½•
# åœ¨ä»£ç ä¸­åŠ è½½å¹¶éªŒè¯è®¸å¯è¯

# 3ï¸âƒ£ å®Œæˆï¼
```

### å…³é”®è¦ç‚¹

âœ… **å®¢æˆ·åç§°å¿…é¡»å®Œå…¨ä¸€è‡´**  
âœ… **ä½¿ç”¨ `/v2` å¯¼å…¥è·¯å¾„**  
âœ… **é…ç½®æ­£ç¡®çš„ go.mod**  
âœ… **å¦¥å–„ä¿ç®¡ç§é’¥**  
âœ… **éªŒè¯è®¸å¯è¯åå†éƒ¨ç½²**

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥) éƒ¨åˆ†
2. è¿è¡Œè°ƒè¯•æ¨¡å¼ï¼š`-debug` å‚æ•°
3. æŸ¥çœ‹æµ‹è¯•ç¨‹åºï¼š`test_license.go` å’Œ `test_full.go`
4. æ£€æŸ¥è¯¦ç»†æŠ¥å‘Šï¼š`æµ‹è¯•éªŒè¯æŠ¥å‘Š.md`

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-12-14  
**çŠ¶æ€**: âœ… å·²éªŒè¯å¯ç”¨
