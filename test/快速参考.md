# ğŸš€ è®¸å¯è¯ç”Ÿæˆå™¨ - å¿«é€Ÿå‚è€ƒ

## ä¸€åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

```bash
# è¿›å…¥ç›®å½•
cd /workspaces/unioffice/test

# ç”Ÿæˆè®¸å¯è¯
go run license_gen.go -customer "æ‚¨çš„åå­—" -output license.key -privkey new_private.pem

# éªŒè¯è®¸å¯è¯
go run test_license.go
```

çœ‹åˆ° `âœ… All tests passed!` å°±æˆåŠŸäº†ï¼

---

## ğŸ“ å‘½ä»¤å‚æ•°

### ç”Ÿæˆè®¸å¯è¯
```bash
go run license_gen.go [é€‰é¡¹]
```

| å‚æ•° | è¯´æ˜ | å¿…å¡« | é»˜è®¤å€¼ |
|------|------|------|--------|
| `-customer` | å®¢æˆ·åç§° | âœ… æ˜¯ | - |
| `-output` | è¾“å‡ºæ–‡ä»¶å | âŒ å¦ | `license.key` |
| `-privkey` | ç§é’¥æ–‡ä»¶è·¯å¾„ | âŒ å¦ | `private.pem` |
| `-debug` | æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ | âŒ å¦ | `false` |
| `-genkeys` | ç”Ÿæˆæ–°å¯†é’¥å¯¹ | âŒ å¦ | `false` |
| `-pubkey` | å…¬é’¥è¾“å‡ºè·¯å¾„ï¼ˆç”Ÿæˆå¯†é’¥æ—¶ï¼‰ | âŒ å¦ | `public.pem` |

### ç¤ºä¾‹å‘½ä»¤

```bash
# åŸºç¡€ç”Ÿæˆ
go run license_gen.go -customer "ABC Corp" -output abc.key -privkey new_private.pem

# è°ƒè¯•æ¨¡å¼
go run license_gen.go -customer "Test" -debug -privkey new_private.pem

# ç”Ÿæˆæ–°å¯†é’¥å¯¹ï¼ˆé«˜çº§ï¼‰
go run license_gen.go -genkeys -privkey my_key.pem -pubkey my_pub.pem
```

---

## ğŸ’» ä»£ç æ¨¡æ¿

### æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼

```go
package main

import (
    "os"
    "github.com/unidoc/unioffice/v2/common/license"
    "github.com/unidoc/unioffice/v2/document"
)

func main() {
    // 1. åŠ è½½è®¸å¯è¯
    lic, _ := os.ReadFile("license.key")
    
    // 2. éªŒè¯ï¼ˆå®¢æˆ·åå¿…é¡»ä¸ç”Ÿæˆæ—¶ä¸€è‡´ï¼ï¼‰
    license.SetLicenseKey(string(lic), "æ‚¨çš„åå­—")
    
    // 3. ä½¿ç”¨
    doc := document.New()
    para := doc.AddParagraph()
    para.AddRun().AddText("Hello World!")
    doc.SaveToFile("output.docx")
}
```

### å¸¦é”™è¯¯å¤„ç†

```go
package main

import (
    "fmt"
    "os"
    "github.com/unidoc/unioffice/v2/common/license"
    "github.com/unidoc/unioffice/v2/document"
)

func main() {
    // åŠ è½½è®¸å¯è¯
    licData, err := os.ReadFile("license.key")
    if err != nil {
        fmt.Printf("âŒ æ— æ³•è¯»å–è®¸å¯è¯: %v\n", err)
        return
    }

    // éªŒè¯è®¸å¯è¯
    err = license.SetLicenseKey(string(licData), "æ‚¨çš„åå­—")
    if err != nil {
        fmt.Printf("âŒ è®¸å¯è¯éªŒè¯å¤±è´¥: %v\n", err)
        return
    }

    fmt.Println("âœ… è®¸å¯è¯å·²åŠ è½½")

    // åˆ›å»ºæ–‡æ¡£
    doc := document.New()
    para := doc.AddParagraph()
    run := para.AddRun()
    run.AddText("Hello from UniOffice!")

    err = doc.SaveToFile("output.docx")
    if err != nil {
        fmt.Printf("âŒ ä¿å­˜å¤±è´¥: %v\n", err)
        return
    }

    fmt.Println("âœ… æ–‡æ¡£å·²åˆ›å»º: output.docx")
}
```

### init() è‡ªåŠ¨åŠ è½½

```go
package main

import (
    "log"
    "os"
    "github.com/unidoc/unioffice/v2/common/license"
    "github.com/unidoc/unioffice/v2/document"
)

func init() {
    // ç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½è®¸å¯è¯
    licData, err := os.ReadFile("license.key")
    if err != nil {
        log.Fatal("è®¸å¯è¯æ–‡ä»¶æœªæ‰¾åˆ°:", err)
    }

    err = license.SetLicenseKey(string(licData), "æ‚¨çš„åå­—")
    if err != nil {
        log.Fatal("è®¸å¯è¯éªŒè¯å¤±è´¥:", err)
    }

    log.Println("âœ… è®¸å¯è¯å·²åŠ è½½")
}

func main() {
    // ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦å†åŠ è½½è®¸å¯è¯
    doc := document.New()
    // ... æ‚¨çš„ä»£ç 
}
```

---

## âš™ï¸ go.mod é…ç½®

```go
module your-project

go 1.21

// ä½¿ç”¨æœ¬åœ°ä¿®æ”¹çš„ unioffice
replace github.com/unidoc/unioffice/v2 => /workspaces/unioffice

require github.com/unidoc/unioffice/v2 v2.0.0
```

**é‡è¦**ï¼šå¯¼å…¥è·¯å¾„å¿…é¡»åŒ…å« `/v2`ï¼š

```go
// âœ… æ­£ç¡®
import "github.com/unidoc/unioffice/v2/common/license"
import "github.com/unidoc/unioffice/v2/document"

// âŒ é”™è¯¯
import "github.com/unidoc/unioffice/common/license"
```

---

## âš ï¸ å¸¸è§é”™è¯¯

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ³• |
|---------|------|---------|
| `crypto/rsa: verification error` | ç­¾åéªŒè¯å¤±è´¥ | ç¡®è®¤å…¬é’¥å·²æ­£ç¡®æ›¿æ¢ï¼Œä½¿ç”¨æ­£ç¡®çš„ç§é’¥ |
| `customer name mismatch` | å®¢æˆ·åä¸åŒ¹é… | ç¡®ä¿ç”Ÿæˆå’Œä½¿ç”¨æ—¶åç§°**å®Œå…¨ä¸€è‡´** |
| `cannot find module` | å¯¼å…¥è·¯å¾„é”™è¯¯ | ä½¿ç”¨ `/v2` è·¯å¾„ |
| `License file not found` | æ–‡ä»¶è·¯å¾„é”™è¯¯ | æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å’Œè·¯å¾„æ˜¯å¦æ­£ç¡® |

---

## ğŸ” è°ƒè¯•å‘½ä»¤

```bash
# æŸ¥çœ‹è®¸å¯è¯å†…å®¹
cat license.key | sed -n '2p' | base64 -d | jq .

# éªŒè¯æ–‡ä»¶å­˜åœ¨
ls -l license.key new_private.pem

# æ¸…é™¤ Go ç¼“å­˜
go clean -cache -modcache

# è¿è¡Œæµ‹è¯•
go run test_license.go
go run test_full.go
```

---

## âœ… æ£€æŸ¥æ¸…å•

ç”Ÿæˆè®¸å¯è¯å‰ï¼š
- [ ] ç¡®å®šå®¢æˆ·åç§°ï¼ˆåç»­å¿…é¡»å®Œå…¨ä¸€è‡´ï¼‰
- [ ] ç¡®è®¤ç§é’¥æ–‡ä»¶å­˜åœ¨ (`new_private.pem`)
- [ ] å†³å®šè¾“å‡ºæ–‡ä»¶å

éªŒè¯è®¸å¯è¯å‰ï¼š
- [ ] è®¸å¯è¯æ–‡ä»¶å·²å¤åˆ¶åˆ°é¡¹ç›®ç›®å½•
- [ ] `go.mod` é…ç½®æ­£ç¡®
- [ ] å¯¼å…¥è·¯å¾„åŒ…å« `/v2`
- [ ] å®¢æˆ·åç§°ä¸ç”Ÿæˆæ—¶ä¸€è‡´

éƒ¨ç½²å‰ï¼š
- [ ] æµ‹è¯•é€šè¿‡ (`go run test_license.go`)
- [ ] è®¸å¯è¯ä¿¡æ¯æ­£ç¡®
- [ ] æ–‡æ¡£å¯ä»¥æ­£å¸¸åˆ›å»º
- [ ] ä¸è¦éƒ¨ç½²ç§é’¥æ–‡ä»¶ï¼

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **è¯¦ç»†æ•™ç¨‹**: [ä½¿ç”¨æ•™ç¨‹.md](ä½¿ç”¨æ•™ç¨‹.md)
- **æµ‹è¯•æŠ¥å‘Š**: [æµ‹è¯•éªŒè¯æŠ¥å‘Š.md](æµ‹è¯•éªŒè¯æŠ¥å‘Š.md)
- **æŠ€æœ¯åˆ†æ**: [è®¸å¯éªŒè¯åˆ†ææŠ¥å‘Š.md](è®¸å¯éªŒè¯åˆ†ææŠ¥å‘Š.md)
- **APIæ–‡æ¡£**: [README_LICENSE_GENERATOR.md](README_LICENSE_GENERATOR.md)

---

## ğŸ†˜ å¿«é€Ÿå¸®åŠ©

```bash
# é‡æ–°ç”Ÿæˆè®¸å¯è¯
go run license_gen.go -customer "YourName" -output license.key -privkey new_private.pem

# å®Œæ•´æµ‹è¯•
go run test_full.go

# æŸ¥çœ‹å¸®åŠ©
go run license_gen.go -h
```

**é—®é¢˜ï¼Ÿ** æŸ¥çœ‹ [ä½¿ç”¨æ•™ç¨‹.md](ä½¿ç”¨æ•™ç¨‹.md) çš„æ•…éšœæ’æŸ¥éƒ¨åˆ†

---

**ç‰ˆæœ¬**: 1.0 | **çŠ¶æ€**: âœ… å·²éªŒè¯ | **æ›´æ–°**: 2025-12-14
